# Data Dictionary - Rural Residency Sentiment Analyzer

Documentation of all CSV outputs generated by the `output/` directory.

## 1. reddit_sentiment.csv
**Purpose**: The main dataset containing individual Reddit posts/comments with their metadata, sentiment scores, and flags.
**Update Frequency**: Daily (incremental) or One-time (backfill).
**Granularity**: One row per post or comment.

| Column | Type | Description | Example | Null Handling | Valid Range |
|--------|------|-------------|---------|---------------|-------------|
| `id` | string | Unique Reddit ID | `t3_xyz123` | Never null | Alphanumeric |
| `parent_id` | string | Parent ID (null for top-level posts) | `t3_abc789` | Null if post | Alphanumeric |
| `text` | string | Full original text content | "I loved my rural rotation..." | Never null | Any string |
| `clean_text` | string | Preprocessed text (truncated) | "i loved my rural rotation..." | Never null | Any string (max 2000 chars) |
| `timestamp` | datetime | UTC creation time | `2024-03-15 14:30:00+00:00` | Current time imputed if missing | ISO 8601 |
| `timestamp_pacific` | datetime | Pacific Time creation time | `2024-03-15 07:30:00-07:00` | Derived | ISO 8601 |
| `subreddit` | string | Source subreddit | `Residency` | Never null | String |
| `type` | string | Content type | `Post` or `Comment` | Never null | "Post", "Comment" |
| `score` | integer | Net upvotes (Karma) | `45` | 0 if missing | Integer |
| `sentiment_score` | float | Compound sentiment score | `0.85` | 0.0 if fail | -1.0 to +1.0 |
| `sentiment_label` | string | Sentiment category | `Positive` | "Neutral" if fail | Positive, Negative, Neutral |
| `sentiment_confidence` | float | Model confidence | `0.95` | 0.0 if fail | 0.0 to 1.0 |
| `mentions_oregon` | boolean | Contains Oregon-specific keywords | `True` | False | True/False |
| `mentions_partner` | boolean | Discusses spouse/family | `False` | False | True/False |
| `search_category` | string | Matched search term category | `recruitment` | "other" | comma-separated string |
| `pii_redacted_count` | integer | Number of PII entities found | `2` | 0 | Integer >= 0 |

## 2. sentiment_by_month.csv
**Purpose**: Aggregated trends for time-series visualization.
**Granularity**: One row per month (YYYY-MM).

| Column | Type | Description | Example |
|--------|------|-------------|---------|
| `year_month` | string | Month identifier | `2024-03` |
| `total_posts` | integer | Total posts in that month | `145` |
| `avg_sentiment` | float | Mean sentiment score | `0.12` |
| `pct_negative` | float | Percentage of negative posts | `34.5` |
| `oregon_mentions` | integer | Count of Oregon-related posts | `12` |
| `partner_mentions` | integer | Count of Partner-related posts | `45` |

## 3. negative_keywords.csv
**Purpose**: Most frequent terms appearing in posts flagged as "Negative".
**Granularity**: One row per keyword.

| Column | Type | Description |
|--------|------|-------------|
| `keyword` | string | The extracted term |
| `tfidf_score` | float | TF-IDF relevance score |
| `frequency` | integer | Raw count of occurrences |
| `category` | string | Keyword category (default: negative_tfidf) |

## 4. pii_audit_log.csv
**Purpose**: HIPAA compliance audit trail showing what was redacted and why.
**Note**: Does NOT contain the actual redacted values, only their types and positions.

| Column | Type | Description |
|--------|------|-------------|
| `post_id` | string | Reference to `reddit_sentiment.csv` ID |
| `entity_type` | string | Type of PII detected (PERSON, LOCATION) |
| `start_position` | integer | Character index start |
| `end_position` | integer | Character index end |
| `confidence` | float | Detection confidence score |
| `timestamp` | datetime | When detection occurred |

## 5. topic_summary.csv (v2 feature)
**Purpose**: Summary of topics extracted by BERTopic.
**Note**: Empty in v1 unless `ENABLE_BERTOPIC` is true.

| Column | Type | Description |
|--------|------|-------------|
| `topic_id` | integer | BERTopic cluster ID |
| `topic_name` | string | Generated topic label |
| `top_words` | string | Top 10 words in topic |
| `post_count` | integer | Number of posts in topic |
| `avg_sentiment` | float | Average sentiment of topic |

## 6. run_metadata.json
**Purpose**: Operational metadata for the pipeline run.

```json
{
    "run_timestamp": "2024-03-15T10:00:00Z",
    "version": "v1.0",
    "statistics": {
        "positive_pct": 23.4,
        "pii_redacted_count": 5
    }
}
```

## Relationships
- `reddit_sentiment.id` ↔ `pii_audit_log.post_id`
- `reddit_sentiment.year_month` ↔ `sentiment_by_month.year_month`
- `reddit_sentiment.dominant_topic` ↔ `topic_summary.topic_id`
